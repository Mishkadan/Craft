<?php
/**
* @copyright (C) 2015 iJoomla, Inc. - All rights reserved.
* @license GNU General Public License, version 2 (http://www.gnu.org/licenses/gpl-2.0.html)
* @author iJoomla.com <webmaster@ijoomla.com>
* @url https://www.jomsocial.com/license-agreement
* The PHP code portions are distributed under the GPL license. If not otherwise stated, all images, manuals, cascading style sheets, and included JavaScript *are NOT GPL, and are released under the IJOOMLA Proprietary Use License v1.0
* More info at https://www.jomsocial.com/license-agreement
*/
defined('_JEXEC') or die('Restricted access');
?>

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="498" height="144" viewBox="0 0 498 144" class="joms-hide">
<defs>
<g id="joms-icon-bullhorn">
    <path class="path1" d="M16 6.707c0-3.139-0.919-5.687-2.054-5.707 0.005-0 0.009-0 0.014-0h-1.296c0 0-3.044 2.287-7.425 3.184-0.134 0.708-0.219 1.551-0.219 2.523 0 0.972 0.085 1.816 0.219 2.523 4.382 0.897 7.425 3.184 7.425 3.184h1.296c-0.005 0-0.009-0-0.014-0.001 1.136-0.020 2.054-2.567 2.054-5.707zM13.513 11.551c-0.147 0-0.305-0.152-0.387-0.243-0.197-0.22-0.387-0.562-0.55-0.989-0.363-0.957-0.564-2.239-0.564-3.611 0-1.372 0.2-2.655 0.564-3.611 0.162-0.428 0.353-0.77 0.55-0.99 0.081-0.091 0.24-0.243 0.387-0.243 0.147 0 0.305 0.152 0.387 0.243 0.197 0.22 0.387 0.562 0.55 0.99 0.363 0.957 0.564 2.239 0.564 3.611 0 1.372-0.2 2.655-0.564 3.611-0.162 0.428-0.353 0.77-0.55 0.989-0.081 0.091-0.24 0.243-0.387 0.243zM3.935 6.707c0-0.812 0.060-1.6 0.173-2.33-0.74 0.102-1.39 0.161-2.193 0.161-1.048 0-1.048 0-1.048 0l-0.867 1.479v1.378l0.867 1.479c0 0 0 0 1.048 0 0.803 0 1.453 0.059 2.193 0.161-0.113-0.729-0.173-1.518-0.173-2.33zM5.752 10.034l-2-0.383 1.279 5.024c0.066 0.26 0.324 0.391 0.573 0.291l1.852-0.741c0.249-0.1 0.349-0.374 0.222-0.611l-1.926-3.581zM13.513 8.574c-0.057 0-0.118-0.059-0.149-0.094-0.076-0.085-0.149-0.217-0.212-0.381-0.14-0.369-0.217-0.863-0.217-1.392 0-0.529 0.077-1.023 0.217-1.392 0.063-0.165 0.136-0.297 0.212-0.381 0.031-0.035 0.092-0.094 0.149-0.094 0.056 0 0.118 0.059 0.149 0.094 0.076 0.085 0.149 0.217 0.212 0.381 0.14 0.369 0.217 0.863 0.217 1.392 0 0.529-0.077 1.023-0.217 1.392-0.063 0.165-0.136 0.297-0.212 0.381-0.031 0.035-0.092 0.094-0.149 0.094z"></path>
</g>
<g id="joms-icon-users">
    <path class="path1" d="M11.484 12.584c-0.296-0.047-0.303-0.854-0.303-0.854s0.87-0.854 1.060-2.002c0.51 0 0.825-1.221 0.315-1.65 0.021-0.452 0.656-3.55-2.556-3.55-3.212 0-2.577 3.097-2.556 3.55-0.51 0.43-0.195 1.65 0.315 1.65 0.19 1.148 1.060 2.002 1.060 2.002s-0.007 0.807-0.303 0.854c-0.954 0.15-4.516 1.708-4.516 3.416h12c0-1.708-3.562-3.266-4.516-3.416zM5.376 12.856c0.689-0.424 1.525-0.817 2.212-1.053-0.246-0.351-0.52-0.827-0.693-1.392-0.241-0.196-0.437-0.477-0.562-0.822-0.126-0.345-0.174-0.732-0.135-1.089 0.028-0.256 0.101-0.495 0.213-0.705-0.068-0.728-0.116-2.157 0.819-3.199 0.363-0.404 0.821-0.695 1.37-0.87-0.098-1.012-0.612-2.2-2.601-2.2-3.212 0-2.577 3.097-2.556 3.55-0.51 0.43-0.195 1.65 0.315 1.65 0.19 1.148 1.060 2.002 1.060 2.002s-0.007 0.807-0.303 0.854c-0.954 0.151-4.516 1.708-4.516 3.416h5.15c0.074-0.048 0.149-0.096 0.226-0.144z"></path>
</g>
<g id="joms-icon-envelope">
    <path class="path1" d="M14.5 2h-13c-0.825 0-1.5 0.675-1.5 1.5v10c0 0.825 0.675 1.5 1.5 1.5h13c0.825 0 1.5-0.675 1.5-1.5v-10c0-0.825-0.675-1.5-1.5-1.5zM6.23 8.6l-4.23 3.295v-7.838l4.23 4.543zM2.756 4h10.488l-5.244 3.938-5.244-3.938zM6.395 8.777l1.605 1.723 1.605-1.723 3.29 4.223h-9.79l3.29-4.223zM9.77 8.6l4.23-4.543v7.838l-4.23-3.295z"></path>
</g>
</defs>
</svg>


<?php
if ($my->id != 0) {
    $jinput = JFactory::getApplication()->input;
    $inboxModel         = CFactory::getModel('inbox');
    $notifModel = CFactory::getModel('notification');
    $filter             = array();
    $filter['user_id']  = $my->id;
    $friendModel        = CFactory::getModel ( 'friends' );
    $profileid          = $jinput->get('userid' , 0);

    //CFactory::load( 'libraries' , 'toolbar' );
    $toolbar = CToolbarLibrary::getInstance();
    $newChatCount        = $toolbar->getTotalNotifications( 'chat' );
    $newEventInviteCount    = $toolbar->getTotalNotifications( 'events' );
    $newFriendInviteCount   = $toolbar->getTotalNotifications( 'friends' );
    $newGroupInviteCount    = $toolbar->getTotalNotifications( 'groups' );

    $myParams           =   $my->getParams();
    $newNotificationCount   = $notifModel->getNotificationCount($my->id,'0',$myParams->get('lastnotificationlist',''));
    $newEventInviteCount    = $newEventInviteCount + $newNotificationCount;

    //CFactory::load( 'helpers' , 'string');

    $config = CFactory::getConfig();
    $uri    = CRoute::_('index.php?option=com_community' , false );
    $uri    = base64_encode($uri);

    //CFactory::load('helpers' , 'string' );

    $show_global_notification   = $params->get('show_notification', 1);
    $show_friend_request    = $params->get('show_request', 1);
    $enable_private_message     = $params->get('show_privatemsg', 1);

    // IDs.
    $mainframe = JFactory::getApplication();
    $jinput = $mainframe->input;
    $my = CFactory::getUser();
    $userid = $jinput->get('userid', '', 'INT');
    $user = CFactory::getUser($userid);

    $document->addScriptDeclaration('joms_my_id = ' . $my->id . ';');
    $document->addScriptDeclaration('joms_user_id = ' . $user->id . ';');

?>

<div class="joms-notifications">
  
  
   <li>
            <a class="joms-js--notification-search" href="javascript:" data-ui-object="joms-dropdown-button">
                <svg viewBox="0 0 16 16" class="joms-icon joms-trigger__menu--search">
                    <use xlink:href="<?php echo CRoute::getURI(); ?>#joms-icon-search"></use>
                </svg>
            </a>
            <ul class="joms-popover joms-popover--toolbar-search">
                <li class="joms-js--noremove joms-js--field">
                    <input type="text" class="joms-input" placeholder="<?php echo JText::_('COM_COMMUNITY_SEARCH'); ?>"
                        oninput="joms.view.toolbar.search(this, event);">
                </li>
                <li class="joms-js--noremove joms-js--loading">
                    <img src="<?php echo JURI::root(true); ?>/components/com_community/assets/ajax-loader.gif" alt="loader">
                </li>
                <li class="joms-js--noremove joms-js--viewall">
                    <div>
                        <a href="javascript:" class="joms-button--neutral joms-button--full"
                            data-lang="<?php echo JText::_('COM_COMMUNITY_VIEW_ALL_N_RESULTS'); ?>"></a>
                        <form method="post" action="<?php echo CRoute::_('index.php?option=com_community&view=search&task=advancesearch'); ?>">
                            <input type="hidden" name="q" value="">
                        </form>
                    </div>
                </li>
            </ul>
        </li>
  
  
  <a title=""
            href="#"
            onclick="joms.popup.notification.chat(this); return false;">
        
  
  <svg width="28" height="28" viewBox="0 0 28 28"  xmlns="http://www.w3.org/2000/svg">
<path d="M26.9467 25.0532L22 20.1465C23.9201 17.7524 24.85 14.7136 24.5984 11.6549C24.3468 8.59627 22.9329 5.75025 20.6474 3.70206C18.3618 1.65388 15.3784 0.559219 12.3106 0.643166C9.24271 0.727114 6.32362 1.98329 4.15352 4.15339C1.98341 6.3235 0.727236 9.24259 0.643289 12.3104C0.559341 15.3783 1.654 18.3617 3.70219 20.6472C5.75037 22.9328 8.5964 24.3467 11.6551 24.5983C14.7137 24.8499 17.7525 23.92 20.1467 21.9999L25.0533 26.9065C25.1773 27.0315 25.3247 27.1307 25.4872 27.1984C25.6497 27.2661 25.824 27.3009 26 27.3009C26.176 27.3009 26.3503 27.2661 26.5128 27.1984C26.6752 27.1307 26.8227 27.0315 26.9467 26.9065C27.187 26.6579 27.3213 26.3257 27.3213 25.9799C27.3213 25.6341 27.187 25.3018 26.9467 25.0532ZM12.6667 21.9999C10.8207 21.9999 9.0162 21.4525 7.48134 20.4269C5.94648 19.4014 4.7502 17.9437 4.04379 16.2383C3.33737 14.5328 3.15254 12.6562 3.51267 10.8457C3.87279 9.03521 4.76171 7.37217 6.067 6.06688C7.37229 4.76159 9.03533 3.87267 10.8458 3.51254C12.6563 3.15241 14.5329 3.33725 16.2384 4.04366C17.9438 4.75008 19.4015 5.94636 20.427 7.48122C21.4526 9.01608 22 10.8206 22 12.6665C22 15.1419 21.0167 17.5159 19.2663 19.2662C17.516 21.0165 15.142 21.9999 12.6667 21.9999Z" fill="white"/>
</svg>

   </a>
  
  
  
  
  
   <?php if ($enable_private_message) { ?>
    <a title="<?php echo JText::_('COM_COMMUNITY_NOTIFICATIONS_INBOX'); ?>"
            href="<?php echo CRoute::_('index.php?option=com_community&view=chat'); ?>"
            onclick="joms.popup.notification.chat(this); return false;">
        
		
		<svg width="28" height="22" viewBox="0 0 28 22" xmlns="http://www.w3.org/2000/svg">
<path d="M23.3334 0.333496H4.66675C3.60588 0.333496 2.58847 0.754924 1.83832 1.50507C1.08818 2.25521 0.666748 3.27263 0.666748 4.3335V17.6668C0.666748 18.7277 1.08818 19.7451 1.83832 20.4953C2.58847 21.2454 3.60588 21.6668 4.66675 21.6668H23.3334C24.3943 21.6668 25.4117 21.2454 26.1618 20.4953C26.912 19.7451 27.3334 18.7277 27.3334 17.6668V4.3335C27.3334 3.27263 26.912 2.25521 26.1618 1.50507C25.4117 0.754924 24.3943 0.333496 23.3334 0.333496ZM4.66675 3.00016H23.3334C23.687 3.00016 24.0262 3.14064 24.2762 3.39069C24.5263 3.64074 24.6667 3.97987 24.6667 4.3335L14.0001 10.8402L3.33341 4.3335C3.33341 3.97987 3.47389 3.64074 3.72394 3.39069C3.97399 3.14064 4.31313 3.00016 4.66675 3.00016ZM24.6667 17.6668C24.6667 18.0205 24.5263 18.3596 24.2762 18.6096C24.0262 18.8597 23.687 19.0002 23.3334 19.0002H4.66675C4.31313 19.0002 3.97399 18.8597 3.72394 18.6096C3.47389 18.3596 3.33341 18.0205 3.33341 17.6668V7.3735L13.3067 13.4668C13.5094 13.5839 13.7394 13.6455 13.9734 13.6455C14.2075 13.6455 14.4374 13.5839 14.6401 13.4668L24.6667 7.3735V17.6668Z" fill="white"/>
</svg>

	   
	   
	   
        <span class="joms-js--notiflabel-chat"><?php echo ($newChatCount) ? $newChatCount : ''; ?></span>
		
		
    </a>
    <ul class="joms-popover joms-arrow--top joms-popover--toolbar-chat">
        <li class="joms-js--empty" style="display:block">
            <span><?php echo JText::_('COM_COMMUNITY_CHAT_NOTIF_NO_NEW_MESSAGE') ?></span>
        </li>
        <div>
            <a href="<?php echo CRoute::_('index.php?option=com_community&view=chat'); ?>" class="joms-button--neutral joms-button--full"><?php echo JText::_('COM_COMMUNITY_CHAT_NOTIF_SHOW_ALL') ?></a>
        </div>
    </ul>
    <?php } ?>
  
  
  
  
  
  
  
  
  	  <?php if ($show_global_notification) { ?>
    <a title="<?php echo JText::_('COM_COMMUNITY_NOTIFICATIONS_GLOBAL'); ?>"
            href="javascript:" onclick="joms.popup.notification.global();">
			
			
        <svg width="22" height="28" viewBox="0 0 22 28"  xmlns="http://www.w3.org/2000/svg">
<path d="M18.9999 15.5732V11.3332C18.998 9.444 18.3276 7.61646 17.1074 6.1742C15.8872 4.73194 14.196 3.76803 12.3333 3.45317V1.99984C12.3333 1.64622 12.1928 1.30708 11.9427 1.05703C11.6927 0.80698 11.3535 0.666504 10.9999 0.666504C10.6463 0.666504 10.3072 0.80698 10.0571 1.05703C9.80706 1.30708 9.66658 1.64622 9.66658 1.99984V3.45317C7.80384 3.76803 6.11262 4.73194 4.89243 6.1742C3.67225 7.61646 3.00183 9.444 2.99992 11.3332V15.5732C2.22185 15.8483 1.54792 16.3573 1.0705 17.0304C0.59309 17.7036 0.335571 18.5079 0.333252 19.3332V21.9998C0.333252 22.3535 0.473728 22.6926 0.723776 22.9426C0.973825 23.1927 1.31296 23.3332 1.66659 23.3332H5.85325C6.1603 24.463 6.83059 25.4604 7.76071 26.1715C8.69084 26.8826 9.82911 27.2678 10.9999 27.2678C12.1707 27.2678 13.309 26.8826 14.2391 26.1715C15.1692 25.4604 15.8395 24.463 16.1466 23.3332H20.3333C20.6869 23.3332 21.026 23.1927 21.2761 22.9426C21.5261 22.6926 21.6666 22.3535 21.6666 21.9998V19.3332C21.6643 18.5079 21.4067 17.7036 20.9293 17.0304C20.4519 16.3573 19.778 15.8483 18.9999 15.5732ZM5.66658 11.3332C5.66658 9.91868 6.22849 8.56213 7.22868 7.56193C8.22888 6.56174 9.58543 5.99984 10.9999 5.99984C12.4144 5.99984 13.771 6.56174 14.7712 7.56193C15.7713 8.56213 16.3333 9.91868 16.3333 11.3332V15.3332H5.66658V11.3332ZM10.9999 24.6665C10.5345 24.6637 10.078 24.5391 9.67569 24.3052C9.27337 24.0713 8.93927 23.7362 8.70658 23.3332H13.2933C13.0606 23.7362 12.7265 24.0713 12.3241 24.3052C11.9218 24.5391 11.4653 24.6637 10.9999 24.6665ZM18.9999 20.6665H2.99992V19.3332C2.99992 18.9795 3.14039 18.6404 3.39044 18.3904C3.64049 18.1403 3.97963 17.9998 4.33325 17.9998H17.6666C18.0202 17.9998 18.3593 18.1403 18.6094 18.3904C18.8594 18.6404 18.9999 18.9795 18.9999 19.3332V20.6665Z" fill="white"/>
</svg>

		
		
        <span class="joms-js--notiflabel-general"><?php echo ($newEventInviteCount) ? $newEventInviteCount : ''; ?></span>
    </a>
	
	
    <?php } ?>
	
  <a title="" href="/">
<svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
<path d="M16 28C22.6274 28 28 22.6274 28 16C28 9.37258 22.6274 4 16 4C9.37258 4 4 9.37258 4 16C4 22.6274 9.37258 28 16 28Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M4 16H28" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M20.6156 16C20.3889 20.3883 18.7725 24.5908 16.0002 28C13.2279 24.5908 11.6115 20.3883 11.3848 16C11.6115 11.6117 13.2279 7.4092 16.0002 4C18.7725 7.4092 20.3889 11.6117 20.6156 16Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>



  
  </a>
  
  
  
  
  
  
  
    <?php if ($show_friend_request) { ?>
    <a title="<?php echo JText::_('COM_COMMUNITY_NOTIFICATIONS_INVITE_FRIENDS'); ?>"
            href="<?php echo CRoute::_('index.php?option=com_community&view=friends&task=pending'); ?>"
            onclick="joms.popup.notification.friend(); return false;">
       

	   <svg viewBox="0 0 16 16" class="joms-icon">
		
            <use xlink:href="#joms-icon-users"></use>
        </svg>
		
		
        <span class="joms-js--notiflabel-frequest"><?php echo ($newFriendInviteCount) ? $newFriendInviteCount : ''; ?></span>
    </a>
    <?php } ?>
   
	
	
	
	
	

	
	
	
</div>

<?php
    }
?>
